Problem: Best Time to Buy and Sell Stock III (DP Example)

Input: prices = [1, 4, 2]

Let's build the DP table step by step:

Initial Setup:
- dp[i][j][k] = max profit on day i with j transactions completed and k holding state
- j: 0, 1, 2 (transactions completed)
- k: 0 (not holding), 1 (holding)

Step 1: Initialize day 0
- dp[0][0][0] = 0 (not holding, no transactions)
- dp[0][0][1] = -1 (holding, no transactions - bought at price 1)
- dp[0][1][0] = 0 (not holding, 1 transaction)
- dp[0][1][1] = -1 (holding, 1 transaction)
- dp[0][2][0] = 0 (not holding, 2 transactions)
- dp[0][2][1] = -1 (holding, 2 transactions)

DP Table after day 0:
Trans | Not Holding | Holding
  0   |      0      |   -1
  1   |      0      |   -1
  2   |      0      |   -1

Step 2: Process day 1 (price = 4)
For each transaction count j (0, 1, 2):

- dp[1][0][0] = max(dp[0][0][0], dp[0][-1][1] + 4) = max(0, invalid) = 0
- dp[1][0][1] = max(dp[0][0][1], dp[0][0][0] - 4) = max(-1, -4) = -1

- dp[1][1][0] = max(dp[0][1][0], dp[0][0][1] + 4) = max(0, -1 + 4) = 3
- dp[1][1][1] = max(dp[0][1][1], dp[0][1][0] - 4) = max(-1, -4) = -1

- dp[1][2][0] = max(dp[0][2][0], dp[0][1][1] + 4) = max(0, -1 + 4) = 3
- dp[1][2][1] = max(dp[0][2][1], dp[0][2][0] - 4) = max(-1, -4) = -1

DP Table after day 1:
Trans | Not Holding | Holding
  0   |      0      |   -1
  1   |      3      |   -1
  2   |      3      |   -1

Step 3: Process day 2 (price = 2)
For each transaction count j (0, 1, 2):

- dp[2][0][0] = max(dp[1][0][0], invalid) = 0
- dp[2][0][1] = max(dp[1][0][1], dp[1][0][0] - 2) = max(-1, -2) = -1

- dp[2][1][0] = max(dp[1][1][0], dp[1][0][1] + 2) = max(3, -1 + 2) = 3
- dp[2][1][1] = max(dp[1][1][1], dp[1][1][0] - 2) = max(-1, 3 - 2) = 1

- dp[2][2][0] = max(dp[1][2][0], dp[1][1][1] + 2) = max(3, -1 + 2) = 3
- dp[2][2][1] = max(dp[1][2][1], dp[1][2][0] - 2) = max(-1, 3 - 2) = 1

Final DP Table:
Trans | Not Holding | Holding
  0   |      0      |   -1
  1   |      3      |    1
  2   |      3      |    1

Final Answer: max(dp[2][0][0], dp[2][1][0], dp[2][2][0]) = max(0, 3, 3) = 3

The optimal strategy is: Buy at price 1 (day 0), sell at price 4 (day 1) for profit of 3.